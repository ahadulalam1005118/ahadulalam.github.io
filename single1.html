<!DOCTYPE html>
<html lang="en">

  <head>
    
    <!-- Meta Tag -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO -->
    <meta name="description" content="150 words">
    <meta name="author" content="uipasta">
    <meta name="url" content="http://www.yourdomainname.com">
    <meta name="copyright" content="company name">
    <meta name="robots" content="index,follow">
    
    
    <title>DevBlog - Personal Blog Template</title>
    
    <!-- Favicon -->
    <link rel="shortcut icon" href="images/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="144x144" type="image/x-icon" href="images/favicon/apple-touch-icon.png">
    
    <!-- All CSS Plugins -->
    <link rel="stylesheet" type="text/css" href="css/plugin.css">
    
    <!-- Main CSS Stylesheet -->
    <link rel="stylesheet" type="text/css" href="css/style.css">
    
    <!-- Google Web Fonts  -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:400,300,500,600,700">
    
    <!-- Syntax Highlighter  -->
    <link rel="stylesheet" type="text/css" href="css/syntax/shCore.css">
    <link rel="stylesheet" type="text/css" href="css/syntax/shThemeDefault.css">
    
    
    <!-- HTML5 shiv and Respond.js support IE8 or Older for HTML5 elements and media queries -->
    <!--[if lt IE 9]>
	   <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	   <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    

  </head>

 <body>

	
     
	 <!-- Preloader Start -->
     <div class="preloader">
	   <div class="rounder"></div>
      </div>
      <!-- Preloader End -->
      
      
    
    
    <div id="main">
        <div class="container">
            <div class="row">
            	
               
                 
                 <!-- About Me (Left Sidebar) Start -->
                 <div class="col-md-3">
                   <div class="about-fixed">
                    
                     <div class="my-pic">
                        <img src="images/pic/my-pic.png" alt="">
                        <a href="javascript:void(0)" class="collapsed" data-target="#menu" data-toggle="collapse"><i class="icon-menu menu"></i></a>
                         <div id="menu" class="collapse">
                           <ul class="menu-link">
                               <li><a href="about.html">About</a></li>
                               <li><a href="work.html">Work</a></li>
                               <li><a href="contact.html">Contact</a></li>
                            </ul>
                         </div>
                        </div>
                      
                      
                      
                      <div class="my-detail">
                    	
                        <div class="white-spacing">
                            <h1>Alex Parker</h1>
                            <span>Web Developer</span>
                        </div> 
                       
                       <ul class="social-icon">
                         <li><a href="#" target="_blank" class="facebook"><i class="fa fa-facebook"></i></a></li>
                         <li><a href="#" target="_blank" class="twitter"><i class="fa fa-twitter"></i></a></li>
                         <li><a href="#" target="_blank" class="linkedin"><i class="fa fa-linkedin"></i></a></li>
                         <li><a href="#" target="_blank" class="github"><i class="fa fa-github"></i></a></li>
                        </ul>

                    </div>
                  </div>
                </div>
                <!-- About Me (Left Sidebar) End -->
                
                
                
                
                 
                 <!-- Blog Post (Right Sidebar) Start -->
                 <div class="col-md-9">
                    <div class="col-md-12 page-body">
                    	<div class="row">
                    		
                            
                            <div class="sub-title">
                           		<a href="index.html" title="Go to Home Page"><h2>Back Home</h2></a>
                                <a href="#comment" class="smoth-scroll"><i class="icon-bubbles"></i></a>
                             </div>
                            
                            
                            <div class="col-md-12 content-page">
                              <div class="col-md-12 blog-post">
                            	
                                
                                <!-- Post Headline Start -->
                                <div class="post-title">
                                    <h1>Load testing procedure</h1> 
                                   </div>
                                   <!-- Post Headline End -->
                                    
                                    
                                <!-- Post Detail Start -->
                                <div class="post-info">
                                    <span>November 23, 2016 / by <a href="#" target="_blank">Muhammad Ahad Ul Alam</a></span>
                                   </div>
                                   <!-- Post Detail End -->
                                    
                                    
                                    Performance Testing:

 technical & formal evaluation for responsiveness, speed, scalability and stability characteristics.
(spike,endurance,load,stress)

Load Testing:

The main goal of load testing is to identify the upper limit of the system in terms of database, hardware and network etc.
Helps to determine:
Throughput
Peak Production Load
Load balancing requirements
Stress Testing:

 It is done to evaluate the application's behaviour beyond normal or peak load conditions. 
It is basically testing the functionality of the application under high loads.
“Fatigue test”.


Important metrics:

Throughput
Response time
Tuning 
Benchmarking






performance test process:

planning test      ->      creating scenario   ->   creating scripts ->   running the scenario -> 
                                                

monitoring the scenario -> analyze test results



Planning test:

Which tool can be used for load testing purpose? [options: apache benchmeter,loadrunner, apache jmeter]
How many machines can be used?
Machines configurations?
How to automate something of the whole processes?(if possible)

Backend: 38.108.92.206
cache :38.127.68.36

Development purpose :(as 503 from 38.108.92.206)
Backend:38.127.68.37
Cache: 38.127.68.36

Creating scenarios:

Enumeration of test cases:
Varying(1/0) some metrics that we fixed earlier, we enumerated some test cases.
Metrics are
1)protocol
    HTTP
    HTTPS
2)URL
    Same
    Different
3)Server
    Backend
    Cache
        Miss
        Hit
4)Load
    Without
    With
Should be total 24 cases.
But same url cache miss not possible that’s why total 20 test cases.

A shell script is written by which we can determine some metrics say download time,connect time etc.
We run this to hit same url either in backend or cache depending on test cases.


We use total 10 machines for this purpose

We had two options:
Either to follow master/slave or run independently jmeter in every machines. Following latter one, it can be easier for us to have machine independent data.
So we followed second one.


We used ansible to transfer necessary file (TC’s etc.) to every machines and running jmeter script and bash script in all machines and save the output files to specified folder.


Then another bash script is written to move all output files to central one and convert them to a csv file.,So that it can be easier to analyze the test results both test case based and machines based.



Creating Scripts:
Scripts to extract all url
Scripts to split url’s to 400 files (diff. Url case)
Bash script that extract some metrics from every url request
Jmeter scripts for all test cases
Scripts to move all files to central one and generate a csv file from provided datas.


Running the scenario:

It’s a boring task !!!
Because if we fix 30min/tc then it takes 10hr to finish all testcase
We run this scenario 4 times.

After first run we decided to change some parameters regarding varnish 



Monitoring the scenario:

We monitored the cpu usage of cache server while running test cases in cache server. We observed that all 48 cores were of 70-80% of it’s memory in use.
After running 1st round we observed that some parameters of both varnish and machine’s network related must be “Tuned”.
And here comes the concept of tuning



Tuning:
Baseline -> Collect data -> analyze results -> configure -> test and measure

This process repeated multiple time


The parameters related to varnish that may have impact on performance we assumed---->

Thread pools (most practitioner suggests to keep it’s value exactly 2)
Thread_pool_minimum( 400 this time total 800 threads created initially)
Thread_pool_maximum(5000)
thread_pull_stack(64k) ->         
maximum total memory required for worker thread stacks is in the order of size =
                                           thread_pools x thread_pool_max x thread_pool_stack.
Should be kept minimum in order to reduce memory usage. But not very low to occur stack overflow.

Thread_queue_limit(100) ->  This sets the number of requests we will queue, waiting for an
        available thread. 

Workspace_thread (8k) -> bytes of aux. ws/threadhaving too little space occurs more system calls   
Workspace_session(4k) -> alloc. Size for all session structure and workspace
Listen_depth (4096) ->  (not very much effect actually)
Pipe_timeout(30 sec) -> Idle timeout per session
Thread_pull_reserved(20)
Timeout_idle(5s) -> idle timeout for per connection
Send_timeout
Lru_interval(20s) -> Grace period before object moves on LRU list.


Network parameter tuning:







Analyze Test Results:

              
We analyze  test cases and here are our findings.
In every machines TC0’s(backend same without) download time is greater than TC2’s download time(as expected). Furthermore,the condition holds upto 6-7 thread per machine
In every machines TC1’s(backend same without) download time is less than TC3’s download time(as expected).even cache’s download time be 5-6 times of backends .
So  question arises,
 Do varnish restrict concurrent request at a time for same object?

3)From TC7 and TC9 we get expected results
4)From TC7 and TC11 we get expected results
** TC9 is a little bit faulty. We can’t be able to generate a scenario of all misses. But the ratio of miss/hit may be 6:4.



Future work:
To automate the system so that we can use server as many as we want and run all test cases using single command for a specific time reserved for each test case.
A UI if possible.
 



    
        






:



                                  
                                  
                                  
                                  <!-- Post Author Bio Box Start -->
                                  <div class="about-author margin-top-70 margin-bottom-50">
                                    
                                    <div class="picture">
                                      <img src="images/blog/author.png" class="img-responsive" alt="">
                                     </div>
                                   
                                    <div class="c-padding">
                                       <h3>Article By <a href="#" target="_blank" data-toggle="tooltip" data-placement="top" title="Visit Alex Website">Alex Parker</a></h3>
                                       <p>A passionate developer</p>
                                      </div>
                                    </div>
                                    <!-- Post Author Bio Box End -->
                                    
                                    
                                    
                                    
                                  <!-- You May Also Like Start -->
                                  <div class="you-may-also-like margin-top-50 margin-bottom-50">
                                    <h3>You may also like</h3>
                                     <div class="row">
                                 
                                    <div class="col-md-4 col-sm-6 col-xs-12">
                                      <a href="single.html"><p>Make mailchimp singup form working with ajax using jquery plugin</p></a>
                                     </div>
                    
                                    <div class="col-md-4 col-sm-6 col-xs-12">
                                      <a href="single.html"><p>How to design elegant e-mail newsletter in html for wish christmas to your subscribers?</p></a>
                                     </div>
                    
                                    <div class="col-md-4 col-sm-6 col-xs-12">
                                      <a href="single.html"><p>How to customize a wordpress theme entirely from scratch using a child theme?</p></a>
                                     </div>
                                    
                                    </div>
                                  </div>
                                  <!-- You May Also Like End -->
                                    
                                   
                                  
                                  
                                  <!-- Post Comment (Disqus) Start -->
                                  <div id="comment" class="comment">
                                    <h3>Discuss about post</h3>
                                     
                                     
                                     <!-- Disqus Code Start  (Please Note: Disqus will not be load on local, You have to upload it on server.)-->
                                     <div id="disqus_thread"></div>
							          <script>
					
					/***  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables.
							
							var disqus_config = function () {
							this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
							this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
							};
							*/
							
							           (function() { // DON'T EDIT BELOW THIS LINE
							           var d = document, s = d.createElement('script');
							           s.src = '//uipasta.disqus.com/embed.js';   // Please change the url from your own disqus id
							           s.setAttribute('data-timestamp', +new Date());
							           (d.head || d.body).appendChild(s);
							           })();
							          </script>
			  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
              <!-- Disqus Code End -->
              
                                   </div>
                                   <!-- Post Comment (Disqus) End -->
                                  
                                   

                                </div>    
                             </div>
                              
                         </div>
                         
                        
                        
                        <!-- Subscribe Form Start -->
                        <div class="col-md-8 col-md-offset-2">
                           <form id="mc-form" method="post" action="http://uipasta.us14.list-manage.com/subscribe/post?u=854825d502cdc101233c08a21&amp;id=86e84d44b7">
								
						  <div class="subscribe-form margin-top-20">
							 <input id="mc-email" type="email" placeholder="Email Address" class="text-input">
							  <button class="submit-btn" type="submit">Submit</button>
								</div>
                                <p>Subscribe to my weekly newsletter</p>
								<label for="mc-email" class="mc-label"></label>
							  </form>
                             
                           </div>
                           <!-- Subscribe Form End -->
                           
                           
                         </div>
                     
                     
                       
                       <!-- Footer Start -->
                       <div class="col-md-12 page-body margin-top-50 footer">
                          <footer>
                          <ul class="menu-link">
                               <li><a href="index.html">Home</a></li>
                               <li><a href="about.html">About</a></li>
                               <li><a href="work.html">Work</a></li>
                               <li><a href="contact.html">Contact</a></li>
                            </ul>
                            
                          <p>© Copyright 2016 DevBlog. All rights reserved</p>
						  
						  
						  <!-- UiPasta Credit Start -->
                          <div class="uipasta-credit">Design By <a href="http://www.uipasta.com" target="_blank">UiPasta</a></div>
                          <!-- UiPasta Credit End -->
						  
                           
                         </footer>
                       </div>
                       <!-- Footer End -->
                     
                     
                  </div>
                  <!-- Blog Post (Right Sidebar) End -->
                
            </div>
         </div>
      </div>
    
    
    
     
     <!-- Endpage Box (Popup When Scroll Down) Start -->
     <div id="scroll-down-popup" class="endpage-box">
       <h4>Read Also</h4>
       <a href="#">How to make your company website based on bootstrap framework...</a>
      </div>
      <!-- Endpage Box (Popup When Scroll Down) End -->
      
    
    
    
    <!-- Back to Top Start -->
    <a href="#" class="scroll-to-top"><i class="fa fa-long-arrow-up"></i></a>
    <!-- Back to Top End -->
    
    
    <!-- All Javascript Plugins  -->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/plugin.js"></script>
    
    <!-- Main Javascript File  -->
    <script type="text/javascript" src="js/scripts.js"></script>
    
    <!-- Syntax Highlighter Javascript File  -->
    <script type="text/javascript" src="js/syntax/shCore.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushCss.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushJScript.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushPerl.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushPhp.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushPlain.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushPython.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushRuby.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushSql.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushVb.js"></script>
    <script type="text/javascript" src="js/syntax/shBrushXml.js"></script>
    
	<!-- Syntax Highlighter Call Function -->
	<script type="text/javascript">
		SyntaxHighlighter.config.clipboardSwf = 'js/syntax/clipboard.swf';
		SyntaxHighlighter.all();
	</script>

    
   </body>
 </html>
